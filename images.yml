1.4.0-cuda10.1-ubuntu16.04:
  extra_tags:
  - 1.4.0-cuda10.1
  template:
    path: templates/ubuntu16.04.dockerfile.jinja2
    vars:
      base_image: nvidia/cuda:10.1-base-ubuntu16.04
      additional_steps: |-
        # CUDA 10.1-specific steps
        RUN conda install -y -c pytorch \
            cudatoolkit=10.1 \
            "pytorch=1.4.0=py3.6_cuda10.1.243_cudnn7.6.3_0" \
            "torchvision=0.5.0=py36_cu101" \
         && conda clean -ya

1.4.0-cuda9.2-ubuntu16.04:
  extra_tags:
  - 1.4.0-cuda9.2
  template:
    path: templates/ubuntu16.04.dockerfile.jinja2
    vars:
      base_image: nvidia/cuda:9.2-base-ubuntu16.04
      additional_steps: |-
        # CUDA 9.2-specific steps
        RUN conda install -y -c pytorch \
            cudatoolkit=9.2 \
            "pytorch=1.4.0=py3.6_cuda9.2.148_cudnn7.6.3_0" \
            "torchvision=0.5.0=py36_cu92" \
         && conda clean -ya

1.4.0-nocuda-ubuntu16.04:
  extra_tags:
  - 1.4.0-nocuda
  template:
    path: templates/ubuntu16.04.dockerfile.jinja2
    vars:
      base_image: ubuntu:16.04
      additional_steps: |-
        # No CUDA-specific steps
        ENV NO_CUDA=1
        RUN conda install -y -c pytorch \
            cpuonly \
            "pytorch=1.4.0=py3.6_cpu_0" \
            "torchvision=0.5.0=py36_cpu" \
         && conda clean -ya
